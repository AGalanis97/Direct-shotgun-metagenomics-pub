args = commandArgs(trailingOnly=TRUE)


dataframe <- read.delim(file = "RJ_J_S2_classified.txt", sep = '\t', header = FALSE,strip.white = TRUE)[,-c(1)]
kraken2_output_names <- c("Reads_assigned_rooted_at_taxon", "Reads_assigned_directly_to_taxon","Rank_code","Taxonomic_ID","Name")
colnames(dataframe) <- kraken2_output_names
dataframe <- subset(dataframe, dataframe$Reads_assigned_rooted_at_taxon >= 5000)
angiosperms <- which(dataframe$Name == "Magnoliopsida")
classes <- which(dataframe$Rank_code == "C")


new_dataframe <- dataframe[angiosperms:(classes[match(angiosperms,classes)+1])-1,]

return_genera <- new_dataframe$Taxonomic_ID[new_dataframe$Rank_code == "G"]
return_genera_t <- as.matrix(t(return_genera))
write.table(return_genera_t, file = "genera.txt",sep = " ", quote = F, row.names = F, col.names = F)

match(angiosperms,classes)


newnw <- new_dataframe$Reads_assigned_rooted_at_taxon[new_dataframe$Rank_code == "G"]
sum(newnw)
