SeasonalDifAll<-SeasonalDifAll[grepl("Viridiplantae", SeasonalDifAll$Kingdom),]
SeasonalDifAll<-SeasonalDifAll[,-(2:11)]
SeasonalDifAll<-merge(SeasonalDifAll,,by="plantsgenus")
SeasonalDifAll<-merge(SeasonalDifAll,by="plantsgenus")
SeasonalDifAll<-merge(SeasonalDifAll,plantsgenus,by="plantsgenus")
library(treemap)
#All plants
plantsfamilies<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Normalised_reads/normalised_methodseason_family.csv", header = TRUE)
plantsfamilies<-plantsfamilies[grepl("Viridiplantae", plantsfamilies$Kingdom),]
plantsfamilies$Sum<-rowSums(plantsfamilies[3:10])
plantsgenus<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Normalised_reads/normalised_methodseason_genus.csv", header = TRUE)
plantsgenus<-plantsgenus[grepl("Viridiplantae", plantsgenus$Kingdom),]
plantsgenus$Sum<-rowSums(plantsgenus[3:10])
plantsspecies<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Normalised_reads/normalised_methodseason_species.csv", header = TRUE)
plantsspecies<-plantsspecies[grepl("Viridiplantae", plantsspecies$Kingdom),]
plantsspecies$Sum<-rowSums(plantsspecies[3:10])
treemap<-plantsgenus[!(rowSums(plantsgenus[3:10])<=200), ]
treemap<-data.frame(treemap$Family,treemap$Genus,treemap$Sum)
colnames(treemap)<-c("Family","Genus","Sum")
# treemap
treemap(treemap,
index=c("Family","Genus"),
vSize="Sum",
type="index",
palette = "RdYlGn",
fontsize.labels=c(15,10),
border.col=c("black","black"),
border.lwds=c(1,1) ,
fontcolor.labels=c("black","black"),
fontface.labels=c(1,3),
bg.labels=c("transparent"),
align.labels=list(
c("center", "center"),
c("right", "bottom")
),
overlap.labels=1,
inflate.labels=F,
title="Diversity of foraged plants around the apiary",
fontsize.title=16)
#percentage
library("tidyverse")
Percent <- treemap %>%
select(Sum)
Percent2 <- Percent / colSums(Percent) * 100
colnames(Percent2)<-c("percent")
treemap<-cbind(treemap,Percent2)
#Differential plant genus across seasons (from Cluster analysis)
SeasonalDifCl1<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Figures/Figure_3/Cluster/Genus_cluster_1.csv", header = TRUE)
SeasonalDifCl3<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Figures/Figure_3/Cluster/Genus_cluster_3.csv", header = TRUE)
SeasonalDifCl4<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Figures/Figure_3/Cluster/Genus_cluster_4.csv", header = TRUE)
SeasonalDifAll<-rbind(SeasonalDifCl1,SeasonalDifCl3,SeasonalDifCl4)
SeasonalDifAll<-SeasonalDifAll[grepl("Viridiplantae", SeasonalDifAll$Kingdom),]
SeasonalDifAll<-SeasonalDifAll[,-(2:11)]
SeasonalDifAll<-merge(SeasonalDifAll,plantsgenus,by="plantsgenus")
library(treemap)
#All plants
plantsfamilies<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Normalised_reads/normalised_methodseason_family.csv", header = TRUE)
plantsfamilies<-plantsfamilies[grepl("Viridiplantae", plantsfamilies$Kingdom),]
plantsfamilies$Sum<-rowSums(plantsfamilies[3:10])
plantsgenus<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Normalised_reads/normalised_methodseason_genus.csv", header = TRUE)
plantsgenus<-plantsgenus[grepl("Viridiplantae", plantsgenus$Kingdom),]
plantsgenus$Sum<-rowSums(plantsgenus[3:10])
plantsspecies<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Normalised_reads/normalised_methodseason_species.csv", header = TRUE)
plantsspecies<-plantsspecies[grepl("Viridiplantae", plantsspecies$Kingdom),]
plantsspecies$Sum<-rowSums(plantsspecies[3:10])
treemap<-plantsgenus[!(rowSums(plantsgenus[3:10])<=200), ]
treemap<-data.frame(treemap$Family,treemap$Genus,treemap$Sum)
colnames(treemap)<-c("Family","Genus","Sum")
# treemap
treemap(treemap,
index=c("Family","Genus"),
vSize="Sum",
type="index",
palette = "RdYlGn",
fontsize.labels=c(15,10),
border.col=c("black","black"),
border.lwds=c(1,1) ,
fontcolor.labels=c("black","black"),
fontface.labels=c(1,3),
bg.labels=c("transparent"),
align.labels=list(
c("center", "center"),
c("right", "bottom")
),
overlap.labels=1,
inflate.labels=F,
title="Diversity of foraged plants around the apiary",
fontsize.title=16)
#percentage
library("tidyverse")
Percent <- treemap %>%
select(Sum)
Percent2 <- Percent / colSums(Percent) * 100
colnames(Percent2)<-c("percent")
treemap<-cbind(treemap,Percent2)
#Differential plant genus across seasons (from Cluster analysis)
SeasonalDifCl1<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Figures/Figure_3/Cluster/Genus_cluster_1.csv", header = TRUE)
SeasonalDifCl3<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Figures/Figure_3/Cluster/Genus_cluster_3.csv", header = TRUE)
SeasonalDifCl4<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Figures/Figure_3/Cluster/Genus_cluster_4.csv", header = TRUE)
SeasonalDifAll<-rbind(SeasonalDifCl1,SeasonalDifCl3,SeasonalDifCl4)
SeasonalDifAll<-SeasonalDifAll[grepl("Viridiplantae", SeasonalDifAll$Kingdom),]
SeasonalDifAll<-SeasonalDifAll[,-(2:11)]
SeasonalDifAll<-merge(SeasonalDifAll,plantsgenus,by="plantsgenus")
SeasonalDifAll<-merge(SeasonalDifAll,plantsgenus,by="genus")
SeasonalDifAll<-merge(SeasonalDifAll,plantsgenus,by="Genus")
View(SeasonalDifAll)
#Differential plant genus across seasons (from Cluster analysis)
SeasonalDifCl1<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Figures/Figure_3/Cluster/Genus_cluster_1.csv", header = TRUE)
SeasonalDifCl3<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Figures/Figure_3/Cluster/Genus_cluster_3.csv", header = TRUE)
SeasonalDifCl4<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Figures/Figure_3/Cluster/Genus_cluster_4.csv", header = TRUE)
SeasonalDifAll<-rbind(SeasonalDifCl1,SeasonalDifCl3,SeasonalDifCl4)
SeasonalDifAll<-SeasonalDifAll[grepl("Viridiplantae", SeasonalDifAll$Kingdom),]
View(SeasonalDifAll)
SeasonalDifAll<-SeasonalDifAll[,-(2:10,12)]
SeasonalDifAll<-SeasonalDifAll[,-c(2:10,12)]
View(SeasonalDifAll)
#Differential plant genus across seasons (from Cluster analysis)
SeasonalDifCl1<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Figures/Figure_3/Cluster/Genus_cluster_1.csv", header = TRUE)
SeasonalDifCl3<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Figures/Figure_3/Cluster/Genus_cluster_3.csv", header = TRUE)
SeasonalDifCl4<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Figures/Figure_3/Cluster/Genus_cluster_4.csv", header = TRUE)
SeasonalDifAll<-rbind(SeasonalDifCl1,SeasonalDifCl3,SeasonalDifCl4)
SeasonalDifAll<-SeasonalDifAll[grepl("Viridiplantae", SeasonalDifAll$Kingdom),]
SeasonalDifAll<-SeasonalDifAll[,-c(1:10,12)]
SeasonalDifAll<-merge(SeasonalDifAll,plantsgenus,by="Genus")
#Differential plant genus across seasons (from Cluster analysis)
SeasonalDifCl1<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Figures/Figure_3/Cluster/Genus_cluster_1.csv", header = TRUE)
SeasonalDifCl3<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Figures/Figure_3/Cluster/Genus_cluster_3.csv", header = TRUE)
SeasonalDifCl4<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Figures/Figure_3/Cluster/Genus_cluster_4.csv", header = TRUE)
SeasonalDifAll<-rbind(SeasonalDifCl1,SeasonalDifCl3,SeasonalDifCl4)
SeasonalDifAll<-SeasonalDifAll[grepl("Viridiplantae", SeasonalDifAll$Kingdom),]
SeasonalDifAll<-SeasonalDifAll[,-c(2:10,12)]
View(SeasonalDifAll)
SeasonalDifAll<-merge(SeasonalDifAll,plantsgenus,by="Genus")
View(SeasonalDifAll)
View(treemap)
View(SeasonalDifAll)
###Most abundant and differential plants
DifAb<-data.frame(SeasonalDifAll$Family,SeasonalDifAll$Genus,SeasonalDifAll$Sum)
View(DifAb)
colnames(DifAb)<-c("Family","Genus","Sum")
View(DifAb)
DifAb<-rbind(DifAb,treemap)
treemap<-treemap[,-4]
DifAb<-rbind(DifAb,treemap)
View(DifAb)
###Most abundant and differential plants
DifAb<-data.frame(SeasonalDifAll$Family,SeasonalDifAll$Genus,SeasonalDifAll$Sum)
colnames(DifAb)<-c("Family","Genus","Sum")
DifAb$Category<-c("***")
View(DifAb)
library(treemap)
#All plants
plantsfamilies<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Normalised_reads/normalised_methodseason_family.csv", header = TRUE)
plantsfamilies<-plantsfamilies[grepl("Viridiplantae", plantsfamilies$Kingdom),]
plantsfamilies$Sum<-rowSums(plantsfamilies[3:10])
plantsgenus<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Normalised_reads/normalised_methodseason_genus.csv", header = TRUE)
plantsgenus<-plantsgenus[grepl("Viridiplantae", plantsgenus$Kingdom),]
plantsgenus$Sum<-rowSums(plantsgenus[3:10])
plantsspecies<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Normalised_reads/normalised_methodseason_species.csv", header = TRUE)
plantsspecies<-plantsspecies[grepl("Viridiplantae", plantsspecies$Kingdom),]
plantsspecies$Sum<-rowSums(plantsspecies[3:10])
treemap<-plantsgenus[!(rowSums(plantsgenus[3:10])<=200), ]
treemap<-data.frame(treemap$Family,treemap$Genus,treemap$Sum)
colnames(treemap)<-c("Family","Genus","Sum")
# treemap
treemap(treemap,
index=c("Family","Genus"),
vSize="Sum",
type="index",
palette = "RdYlGn",
fontsize.labels=c(15,10),
border.col=c("black","black"),
border.lwds=c(1,1) ,
fontcolor.labels=c("black","black"),
fontface.labels=c(1,3),
bg.labels=c("transparent"),
align.labels=list(
c("center", "center"),
c("right", "bottom")
),
overlap.labels=1,
inflate.labels=F,
title="Diversity of foraged plants around the apiary",
fontsize.title=16)
#percentage
library("tidyverse")
Percent <- treemap %>%
select(Sum)
Percent2 <- Percent / colSums(Percent) * 100
colnames(Percent2)<-c("percent")
treemap<-cbind(treemap,Percent2)
#Differential plant genus across seasons (from Cluster analysis)
SeasonalDifCl1<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Figures/Figure_3/Cluster/Genus_cluster_1.csv", header = TRUE)
SeasonalDifCl3<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Figures/Figure_3/Cluster/Genus_cluster_3.csv", header = TRUE)
SeasonalDifCl4<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Figures/Figure_3/Cluster/Genus_cluster_4.csv", header = TRUE)
SeasonalDifAll<-rbind(SeasonalDifCl1,SeasonalDifCl3,SeasonalDifCl4)
SeasonalDifAll<-SeasonalDifAll[grepl("Viridiplantae", SeasonalDifAll$Kingdom),]
SeasonalDifAll<-SeasonalDifAll[,-c(2:10,12)]
SeasonalDifAll<-merge(SeasonalDifAll,plantsgenus,by="Genus")
###Most abundant and differential plants
DifAb<-data.frame(SeasonalDifAll$Family,SeasonalDifAll$Genus,SeasonalDifAll$Sum)
colnames(DifAb)<-c("Family","Genus","Sum")
DifAb$Category<-c("***")
colnames(treemap[,-4])<-"Category"
View(treemap)
treemap<-treemap[,-4]
View(treemap)
colnames(treemap[,-3])<-"Category"
View(treemap)
colnames(treemap[,-3])<-c("Category")
colnames(treemap[,3])<-c("Category")
colnames(treemap$Sum)<-c("Category")
colnames(treemap$Sum)<-"Category"
colnames(treemap[,3])<-c("Category")
library(treemap)
library("tidyverse")
#All plants
plantsfamilies<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Normalised_reads/normalised_methodseason_family.csv", header = TRUE)
plantsfamilies<-plantsfamilies[grepl("Viridiplantae", plantsfamilies$Kingdom),]
plantsfamilies$Sum<-rowSums(plantsfamilies[3:10])
plantsgenus<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Normalised_reads/normalised_methodseason_genus.csv", header = TRUE)
plantsgenus<-plantsgenus[grepl("Viridiplantae", plantsgenus$Kingdom),]
plantsgenus$Sum<-rowSums(plantsgenus[3:10])
plantsspecies<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Normalised_reads/normalised_methodseason_species.csv", header = TRUE)
plantsspecies<-plantsspecies[grepl("Viridiplantae", plantsspecies$Kingdom),]
plantsspecies$Sum<-rowSums(plantsspecies[3:10])
treemap<-plantsgenus[!(rowSums(plantsgenus[3:10])<=200), ]
treemap<-data.frame(treemap$Family,treemap$Genus,treemap$Sum)
colnames(treemap)<-c("Family","Genus","Sum")
# treemap
treemap(treemap,
index=c("Family","Genus"),
vSize="Sum",
type="index",
palette = "RdYlGn",
fontsize.labels=c(15,10),
border.col=c("black","black"),
border.lwds=c(1,1) ,
fontcolor.labels=c("black","black"),
fontface.labels=c(1,3),
bg.labels=c("transparent"),
align.labels=list(
c("center", "center"),
c("right", "bottom")
),
overlap.labels=1,
inflate.labels=F,
title="Diversity of foraged plants around the apiary",
fontsize.title=16)
#percentage
Percent <- treemap %>%
select(Sum)
Percent2 <- Percent / colSums(Percent) * 100
colnames(Percent2)<-c("Category")
treemap<-cbind(treemap,Percent2)
#Differential plant genus across seasons (from Cluster analysis)
SeasonalDifCl1<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Figures/Figure_3/Cluster/Genus_cluster_1.csv", header = TRUE)
SeasonalDifCl3<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Figures/Figure_3/Cluster/Genus_cluster_3.csv", header = TRUE)
SeasonalDifCl4<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Figures/Figure_3/Cluster/Genus_cluster_4.csv", header = TRUE)
SeasonalDifAll<-rbind(SeasonalDifCl1,SeasonalDifCl3,SeasonalDifCl4)
SeasonalDifAll<-SeasonalDifAll[grepl("Viridiplantae", SeasonalDifAll$Kingdom),]
SeasonalDifAll<-SeasonalDifAll[,-c(2:10,12)]
SeasonalDifAll<-merge(SeasonalDifAll,plantsgenus,by="Genus")
###Most abundant and differential plants
DifAb<-data.frame(SeasonalDifAll$Family,SeasonalDifAll$Genus,SeasonalDifAll$Sum)
colnames(DifAb)<-c("Family","Genus","Sum")
DifAb$Category<-c("***")
treemap<-treemap[,-3]
DifAb<-rbind(DifAb,treemap)
library(treemap)
library("tidyverse")
#All plants
plantsfamilies<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Normalised_reads/normalised_methodseason_family.csv", header = TRUE)
plantsfamilies<-plantsfamilies[grepl("Viridiplantae", plantsfamilies$Kingdom),]
plantsfamilies$Sum<-rowSums(plantsfamilies[3:10])
plantsgenus<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Normalised_reads/normalised_methodseason_genus.csv", header = TRUE)
plantsgenus<-plantsgenus[grepl("Viridiplantae", plantsgenus$Kingdom),]
plantsgenus$Sum<-rowSums(plantsgenus[3:10])
plantsspecies<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Normalised_reads/normalised_methodseason_species.csv", header = TRUE)
plantsspecies<-plantsspecies[grepl("Viridiplantae", plantsspecies$Kingdom),]
plantsspecies$Sum<-rowSums(plantsspecies[3:10])
treemap<-plantsgenus[!(rowSums(plantsgenus[3:10])<=200), ]
treemap<-data.frame(treemap$Family,treemap$Genus,treemap$Sum)
colnames(treemap)<-c("Family","Genus","Sum")
# treemap
treemap(treemap,
index=c("Family","Genus"),
vSize="Sum",
type="index",
palette = "RdYlGn",
fontsize.labels=c(15,10),
border.col=c("black","black"),
border.lwds=c(1,1) ,
fontcolor.labels=c("black","black"),
fontface.labels=c(1,3),
bg.labels=c("transparent"),
align.labels=list(
c("center", "center"),
c("right", "bottom")
),
overlap.labels=1,
inflate.labels=F,
title="Diversity of foraged plants around the apiary",
fontsize.title=16)
#percentage
Percent <- treemap %>%
select(Sum)
Percent2 <- Percent / colSums(Percent) * 100
colnames(Percent2)<-c("Category")
treemap<-cbind(treemap,Percent2)
#Differential plant genus across seasons (from Cluster analysis)
SeasonalDifCl1<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Figures/Figure_3/Cluster/Genus_cluster_1.csv", header = TRUE)
SeasonalDifCl3<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Figures/Figure_3/Cluster/Genus_cluster_3.csv", header = TRUE)
SeasonalDifCl4<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Figures/Figure_3/Cluster/Genus_cluster_4.csv", header = TRUE)
SeasonalDifAll<-rbind(SeasonalDifCl1,SeasonalDifCl3,SeasonalDifCl4)
SeasonalDifAll<-SeasonalDifAll[grepl("Viridiplantae", SeasonalDifAll$Kingdom),]
SeasonalDifAll<-SeasonalDifAll[,-c(2:10,12)]
SeasonalDifAll<-merge(SeasonalDifAll,plantsgenus,by="Genus")
###Most abundant and differential plants
DifAb<-data.frame(SeasonalDifAll$Family,SeasonalDifAll$Genus,SeasonalDifAll$Sum)
colnames(DifAb)<-c("Family","Genus","Sum")
DifAb$Category<-c("***")
DifAb<-rbind(DifAb,treemap)
View(DifAb)
setwd("~/Desktop/plant")
setwd("~/Desktop/plant")
setwd("~/Desktop/plant")
library(treemap)
library("tidyverse")
#All plants
plantsfamilies<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Normalised_reads/normalised_methodseason_family.csv", header = TRUE)
plantsfamilies<-plantsfamilies[grepl("Viridiplantae", plantsfamilies$Kingdom),]
plantsfamilies$Sum<-rowSums(plantsfamilies[3:10])
plantsgenus<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Normalised_reads/normalised_methodseason_genus.csv", header = TRUE)
plantsgenus<-plantsgenus[grepl("Viridiplantae", plantsgenus$Kingdom),]
plantsgenus$Sum<-rowSums(plantsgenus[3:10])
plantsspecies<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Normalised_reads/normalised_methodseason_species.csv", header = TRUE)
plantsspecies<-plantsspecies[grepl("Viridiplantae", plantsspecies$Kingdom),]
plantsspecies$Sum<-rowSums(plantsspecies[3:10])
treemap<-plantsgenus[!(rowSums(plantsgenus[3:10])<=200), ]
treemap<-data.frame(treemap$Family,treemap$Genus,treemap$Sum)
colnames(treemap)<-c("Family","Genus","Sum")
# treemap
treemap(treemap,
index=c("Family","Genus"),
vSize="Sum",
type="index",
palette = "RdYlGn",
fontsize.labels=c(15,10),
border.col=c("black","black"),
border.lwds=c(1,1) ,
fontcolor.labels=c("black","black"),
fontface.labels=c(1,3),
bg.labels=c("transparent"),
align.labels=list(
c("center", "center"),
c("right", "bottom")
),
overlap.labels=1,
inflate.labels=F,
title="Diversity of foraged plants around the apiary",
fontsize.title=16)
#percentage
Percent <- treemap %>%
select(Sum)
Percent2 <- Percent / colSums(Percent) * 100
colnames(Percent2)<-c("Category")
treemap<-cbind(treemap,Percent2)
#Differential plant genus across seasons (from Cluster analysis)
SeasonalDifCl1<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Figures/Figure_3/Cluster/Genus_cluster_1.csv", header = TRUE)
SeasonalDifCl3<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Figures/Figure_3/Cluster/Genus_cluster_3.csv", header = TRUE)
SeasonalDifCl4<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Figures/Figure_3/Cluster/Genus_cluster_4.csv", header = TRUE)
SeasonalDifAll<-rbind(SeasonalDifCl1,SeasonalDifCl3,SeasonalDifCl4)
SeasonalDifAll<-SeasonalDifAll[grepl("Viridiplantae", SeasonalDifAll$Kingdom),]
SeasonalDifAll<-SeasonalDifAll[,-c(2:10,12)]
SeasonalDifAll<-merge(SeasonalDifAll,plantsgenus,by="Genus")
###Most abundant and differential plants
DifAb<-data.frame(SeasonalDifAll$Family,SeasonalDifAll$Genus,SeasonalDifAll$Sum)
colnames(DifAb)<-c("Family","Genus","Sum")
DifAb$Category<-c("***")
DifAb<-rbind(DifAb,treemap)
write.table(DifAb, "DifAb_Genus.txt", sep="\t")
View(SeasonalDifCl1)
View(SeasonalDifCl3)
View(SeasonalDifAll)
View(SeasonalDifCl1)
View(SeasonalDifCl3)
View(SeasonalDifCl4)
setwd("~/Desktop/plant")
library(treemap)
library("tidyverse")
#All plants
plantsfamilies<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Normalised_reads/normalised_methodseason_family.csv", header = TRUE)
plantsfamilies<-plantsfamilies[grepl("Viridiplantae", plantsfamilies$Kingdom),]
plantsfamilies$Sum<-rowSums(plantsfamilies[3:10])
plantsgenus<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Normalised_reads/normalised_methodseason_genus.csv", header = TRUE)
plantsgenus<-plantsgenus[grepl("Viridiplantae", plantsgenus$Kingdom),]
plantsgenus$Sum<-rowSums(plantsgenus[3:10])
plantsspecies<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Normalised_reads/normalised_methodseason_species.csv", header = TRUE)
plantsspecies<-plantsspecies[grepl("Viridiplantae", plantsspecies$Kingdom),]
plantsspecies$Sum<-rowSums(plantsspecies[3:10])
treemap<-plantsgenus[!(rowSums(plantsgenus[3:10])<=200), ]
treemap<-data.frame(treemap$Family,treemap$Genus,treemap$Sum)
colnames(treemap)<-c("Family","Genus","Sum")
# treemap
treemap(treemap,
index=c("Family","Genus"),
vSize="Sum",
type="index",
palette = "RdYlGn",
fontsize.labels=c(15,10),
border.col=c("black","black"),
border.lwds=c(1,1) ,
fontcolor.labels=c("black","black"),
fontface.labels=c(1,3),
bg.labels=c("transparent"),
align.labels=list(
c("center", "center"),
c("right", "bottom")
),
overlap.labels=1,
inflate.labels=F,
title="Diversity of foraged plants around the apiary",
fontsize.title=16)
#percentage
Percent <- treemap %>%
select(Sum)
Percent2 <- Percent / colSums(Percent) * 100
colnames(Percent2)<-c("Category")
treemap<-cbind(treemap,Percent2)
#Differential plant genus across seasons (from Cluster analysis)
SeasonalDifCl1<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Figures/Figure_3/Cluster/Genus_cluster_1.csv", header = TRUE)
SeasonalDifCl3<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Figures/Figure_3/Cluster/Genus_cluster_3.csv", header = TRUE)
SeasonalDifCl4<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Figures/Figure_3/Cluster/Genus_cluster_4.csv", header = TRUE)
SeasonalDifAll<-rbind(SeasonalDifCl1,SeasonalDifCl3,SeasonalDifCl4)
SeasonalDifAll<-SeasonalDifAll[grepl("Viridiplantae", SeasonalDifAll$Kingdom),]
SeasonalDifAll<-SeasonalDifAll[,-c(2:10,12)]
SeasonalDifAll<-merge(SeasonalDifAll,plantsgenus,by="Genus")
###Most abundant and differential plants
DifAb<-data.frame(SeasonalDifAll$Family,SeasonalDifAll$Genus,SeasonalDifAll$Sum)
colnames(DifAb)<-c("Family","Genus","Sum")
DifAb$Category<-c("***")
DifAb<-rbind(DifAb,treemap)
write.table(DifAb, "DifAb_Genus.txt", sep="\t")
View(plantsgenus)
View(plantsspecies)
#All plants
plantsfamilies<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Normalised_reads/normalised_methodseason_family.csv", header = TRUE)
plantsfamilies<-plantsfamilies[grepl("Viridiplantae", plantsfamilies$Kingdom),]
plantsspecies<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Normalised_reads/normalised_methodseason_species.csv", header = TRUE)
plantsspecies<-plantsspecies[grepl("Viridiplantae", plantsspecies$Kingdom),]
View(plantsspecies)
setwd("~/Desktop/plant")
library(treemap)
library("tidyverse")
#All plants
plantsfamilies<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Normalised_reads/normalised_methodseason_family.csv", header = TRUE)
plantsfamilies<-plantsfamilies[grepl("Viridiplantae", plantsfamilies$Kingdom),]
plantsfamilies$Sum<-rowSums(plantsfamilies[3:10])
plantsgenus<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Normalised_reads/normalised_methodseason_genus.csv", header = TRUE)
plantsgenus<-plantsgenus[grepl("Viridiplantae", plantsgenus$Kingdom),]
plantsgenus$Sum<-rowSums(plantsgenus[3:10])
plantsspecies<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Normalised_reads/normalised_methodseason_species.csv", header = TRUE)
plantsspecies<-plantsspecies[grepl("Viridiplantae", plantsspecies$Kingdom),]
plantsspecies$Sum<-rowSums(plantsspecies[3:10])
treemap<-plantsgenus[!(rowSums(plantsgenus[3:10])<=200), ]
treemap<-data.frame(treemap$Family,treemap$Genus,treemap$Sum)
colnames(treemap)<-c("Family","Genus","Sum")
# treemap
treemap(treemap,
index=c("Family","Genus"),
vSize="Sum",
type="index",
palette = "RdYlGn",
fontsize.labels=c(15,10),
border.col=c("black","black"),
border.lwds=c(1,1) ,
fontcolor.labels=c("black","black"),
fontface.labels=c(1,3),
bg.labels=c("transparent"),
align.labels=list(
c("center", "center"),
c("right", "bottom")
),
overlap.labels=1,
inflate.labels=F,
title="Diversity of foraged plants around the apiary",
fontsize.title=16)
#percentage
Percent <- treemap %>%
select(Sum)
Percent2 <- Percent / colSums(Percent) * 100
colnames(Percent2)<-c("Category")
treemap<-cbind(treemap,Percent2)
#Differential plant genus across seasons (from Cluster analysis)
SeasonalDifCl1<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Figures/Figure_3/Cluster/Genus_cluster_1.csv", header = TRUE)
SeasonalDifCl3<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Figures/Figure_3/Cluster/Genus_cluster_3.csv", header = TRUE)
SeasonalDifCl4<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Figures/Figure_3/Cluster/Genus_cluster_4.csv", header = TRUE)
SeasonalDifAll<-rbind(SeasonalDifCl1,SeasonalDifCl3,SeasonalDifCl4)
SeasonalDifAll<-SeasonalDifAll[grepl("Viridiplantae", SeasonalDifAll$Kingdom),]
SeasonalDifAll<-SeasonalDifAll[,-c(2:10,12)]
SeasonalDifAll<-merge(SeasonalDifAll,plantsgenus,by="Genus")
###Most abundant and differential plants
DifAb<-data.frame(SeasonalDifAll$Family,SeasonalDifAll$Genus,SeasonalDifAll$Sum)
colnames(DifAb)<-c("Family","Genus","Sum")
DifAb$Category<-c("***")
DifAb<-rbind(DifAb,treemap)
write.table(DifAb, "DifAb_Genus.txt", sep="\t")
plantsspecies<-read.csv("~/Documents/GitHub/Direct-shotgun-metagenomics-pub/Normalised_reads/normalised_methodseason_species.csv", header = TRUE)
plantsspecies<-plantsspecies[grepl("Viridiplantae", plantsspecies$Kingdom),]
View(plantsspecies)
View(plantsgenus)
